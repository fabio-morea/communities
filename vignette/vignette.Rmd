---
title: "How to use 'communities' package" 
output: pdf
---

# scope

```{r libraries, message=FALSE, warning=FALSE}
library(tidyverse)
library(igraph)
library(communities)
```


# examples
## create a ring of cliques

```{r sample1, message=FALSE, warning=FALSE}
g <- communities::make_ring_of_cliques(num_cliques = 4,
                                       clique_size = 6, 
                                       add_center = F, 
                                       add_bridges = T)
plot(g)
```


## explore solutions space
```{r}
sol_space <- communities::solutions_space(g, tmax = 500, met = "LV", confidence = .9, resolution = 1.0, comp_method = "ami")
M <- sol_space$M 
df <- sol_space$data
sm <- sol_space$simil
plot_sol_space(sol_space)
   simil_df <- as.data.frame(sol_space$simil)
    simil_df$Partition1 <- rownames(simil_df)
    simil_long <- simil_df %>%
        pivot_longer(cols = -Partition1, names_to = "Partition2", values_to = "s")
    
    simil_long <- simil_long %>%
        mutate(Partition1 = factor(Partition1, levels = unique(Partition1)),
               Partition2 = factor(Partition2, levels = unique(Partition2)))
    
    pl4 <-  ggplot(simil_long, aes(x = Partition2, y = Partition1, fill = s)) +
        geom_tile() +
        scale_fill_gradient(low = "white", high = "darkgreen") +
        labs(x = "solutions", y = "solutions", title = "Heatmap of Similarity Matrix") +
        theme_minimal() +
        theme(axis.text.x = element_text(angle = 90, hjust = 1),
              axis.text.y = element_text(hjust = 1))+ theme(aspect.ratio = 1.0)

```

  

```{r}
g <- communities::make_ring_of_cliques(num_cliques = 4,
                                       clique_size = 6, 
                                       add_center = F, 
                                       add_bridges = T)
ssp <- communities::solutions_space(g, tmax = 100, met = "LV", resolution = 1, confidence = .95) 
ssp$data
ssp$M
plot_sol_space(ssp)
```


```{r}
communities::solutions_space(g, tmax = 100, met = "WT",  comp_method = "ami", confidence = 0.95) %>% 
  plot_sol_space()

  

```

```{r}
ssp1 <- communities::solutions_space(g, tmax = 20, met = "LD", resolution = 0.9, comp_method = 'ami')
ssp2 <- communities::solutions_space(g, tmax = 20, met = "LD", resolution = 0.9, comp_method = 'ari') 

ssp1$data
ssp2$data

```


```{r}
plot(g)
communities::solutions_space(g, tmax = 100, met = "WT", comp_method = "ami") %>% plot_sol_space()
 
```

```{r}
random_graph <- erdos.renyi.game(100, p=0.01, type = "gnp")
cluster_louvain(random_graph)
random_ssp <- communities::solutions_space(random_graph,tmax = 1, met = "IM", resolution = .99, comp_method = "ari")

random_ssp$data
random_ssp$M
plot_sol_space(random_ssp)


```

